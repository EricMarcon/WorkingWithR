<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Git and GitHub | Working with R</title>
<meta name="author" content="Eric Marcon">
<meta name="description" content="Source control consists in recording all the modifications made on the tracked files. The advantages are numerous: traceability and security of the project, possibility to collaborate efficiently,...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="3 Git and GitHub | Working with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ericmarcon.github.io/WorkingWithR/chap-git.html">
<meta property="og:description" content="Source control consists in recording all the modifications made on the tracked files. The advantages are numerous: traceability and security of the project, possibility to collaborate efficiently,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Git and GitHub | Working with R">
<meta name="twitter:description" content="Source control consists in recording all the modifications made on the tracked files. The advantages are numerous: traceability and security of the project, possibility to collaborate efficiently,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="libs/vis-9.1.0/vis-network.min.js"></script><script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-7NVD1TWMCJ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-7NVD1TWMCJ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Working with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Presentation</a></li>
<li><a class="" href="chap-logiciels.html"><span class="header-section-number">1</span> Software</a></li>
<li><a class="" href="chap-utiliseR.html"><span class="header-section-number">2</span> Use R</a></li>
<li><a class="active" href="chap-git.html"><span class="header-section-number">3</span> Git and GitHub</a></li>
<li><a class="" href="chap-rediger.html"><span class="header-section-number">4</span> Writing</a></li>
<li><a class="" href="chap-package.html"><span class="header-section-number">5</span> Package</a></li>
<li><a class="" href="chap-ci.html"><span class="header-section-number">6</span> Continuous integration</a></li>
<li><a class="" href="chap-shiny.html"><span class="header-section-number">7</span> Shiny</a></li>
<li><a class="" href="chap-enseigner.html"><span class="header-section-number">8</span> Teaching with R</a></li>
<li><a class="" href="chap-conclusion.html"><span class="header-section-number">9</span> Conclusion</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EricMarcon/WorkingWithR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chap-git" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Git and GitHub<a class="anchor" aria-label="anchor" href="#chap-git"><i class="fas fa-link"></i></a>
</h1>
<p>Source control consists in recording all the modifications made on the tracked files.
The advantages are numerous: traceability and security of the project, possibility to collaborate efficiently, to go back, to try new developments without jeopardizing the stable version…</p>
<div id="sec:principes-git" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Principles<a class="anchor" aria-label="anchor" href="#sec:principes-git"><i class="fas fa-link"></i></a>
</h2>
<div id="sec:git-cds" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Source control<a class="anchor" aria-label="anchor" href="#sec:git-cds"><i class="fas fa-link"></i></a>
</h3>
<p>The standard tool today is <em>git</em>.</p>
<p>The git commands can be executed in the RStudio terminal.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Status"></span>
<img src="images/git-Status.png" alt="Screenshot of the RStudio terminal. The git status command, which is supposed to describe the state of the repository, returns an error if the R project is not under source control." width="80%"><p class="caption">
Figure 3.1: Screenshot of the RStudio terminal. The <code>git status</code> command, which is supposed to describe the state of the repository, returns an error if the R project is not under source control.
</p>
</div>
<p></p>
<p>The <code>git status</code> command (figure <a href="chap-git.html#fig:git-Status">3.1</a>) returns the status of the repository, that is, the set of data managed by git to track the current project.</p>
<p>RStudio integrates a graphical interface for git that is sufficient to do without the command line for standard use, presented here.</p>
</div>
<div id="git-and-github-1" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> git and GitHub<a class="anchor" aria-label="anchor" href="#git-and-github-1"><i class="fas fa-link"></i></a>
</h3>
<p><em>git</em> is the software installed on the workstation.</p>
<p><em>GitHub</em> is a web platform<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/" class="uri"&gt;https://github.com/&lt;/a&gt;&lt;/p&gt;'><sup>31</sup></a>, which allows to share the content of git repositories (to work with several people) and to share documentation in the form of a web site (<em>GitHub Pages</em>).</p>
<p>As GitHub allows at least the backup of git repositories, the two are always used together.
GitHub is not the only platform that can be used but the main one.
Alternatives are Bitbucket<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://bitbucket.org/" class="uri"&gt;https://bitbucket.org/&lt;/a&gt;&lt;/p&gt;'><sup>32</sup></a> and GitLab<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://about.gitlab.com/" class="uri"&gt;https://about.gitlab.com/&lt;/a&gt;&lt;/p&gt;'><sup>33</sup></a> for example.</p>
</div>
</div>
<div id="sec:creerdepot" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Create a new repository<a class="anchor" aria-label="anchor" href="#sec:creerdepot"><i class="fas fa-link"></i></a>
</h2>
<div id="from-an-existing-project" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> From an existing project<a class="anchor" aria-label="anchor" href="#from-an-existing-project"><i class="fas fa-link"></i></a>
</h3>
<p>In an existing R project, enable source control in the project options (figure <a href="chap-git.html#fig:git-Project">3.2</a>).
The command executed is <code>git init</code>.
Restart RStudio on demand.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Project"></span>
<img src="images/git-Project.png" alt="Activation of source control in the menu “Tools &gt; Project Options…”." width="80%"><p class="caption">
Figure 3.2: Activation of source control in the menu “Tools &gt; Project Options…”.
</p>
</div>
<p></p>
<p>A new <em>Git</em> window appears in the upper right panel.
It contains the list of project files (figure <a href="chap-git.html#fig:git-Fichiers">3.3</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Fichiers"></span>
<img src="images/git-Fichiers.png" alt="Project files, not yet taken into account by git." width="80%"><p class="caption">
Figure 3.3: Project files, not yet taken into account by git.
</p>
</div>
<p></p>
<p>At this point, the files are not taken into account by git: their status is a double yellow question mark.
For git, the local working directory is a <em>sandbox</em> where all changes are possible without consequences.</p>
<p>The <code>.gitignore</code> file contains the list of files that are never intended to be taken into account, so there is no need to display them in the list: automatically produced intermediate files for example.
The syntax of <code>.gitignore</code> files is detailed in the git<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://git-scm.com/docs/gitignore" class="uri"&gt;https://git-scm.com/docs/gitignore&lt;/a&gt;&lt;/p&gt;'><sup>34</sup></a> documentation.
As a general rule, use an existing file: document templates in particular include their <code>.gitignore</code> file.</p>
</div>
<div id="taking-files-into-account" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Taking files into account<a class="anchor" aria-label="anchor" href="#taking-files-into-account"><i class="fas fa-link"></i></a>
</h3>
<p>In the git window, checking the <em>Staged</em> checkbox allows you to stage each file.
The command executed is <code>git add &lt;FileName&gt;</code>.
Files taken into account the first time have the status “A” for “Added”.</p>
<p>The files taken into account are part of the git <em>index</em>.</p>
</div>
<div id="committing-changes" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Committing changes<a class="anchor" aria-label="anchor" href="#committing-changes"><i class="fas fa-link"></i></a>
</h3>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Commit"></span>
<img src="images/git-Commit.png" alt="Commit window." width="80%"><p class="caption">
Figure 3.4: Commit window.
</p>
</div>
<p></p>
<p>The staged files can be validated (<em>Committed</em>) by clicking on the “Commit” button in the <em>Git</em> window.
A new window opens (figure <a href="chap-git.html#fig:git-Commit">3.4</a>), which allows to visualize all the modifications by file (additions in green, deletions in red).
The modification grain treated by git is the text line, ended by a line break.
Binary files such as images are processed as a whole.</p>
<p>Each commit comes with a description text.
The first line is the short description.
A detailed description can be added after a line break.
For the readability of the project history, each commit corresponds to an action, corresponding to the short description: not all modified files are necessarily taken into account and validated at once.
The command executed is <code>git commit -m "Commit message"</code>.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-id"></span>
<img src="images/git-id.png" alt="Identification window." width="80%"><p class="caption">
Figure 3.5: Identification window.
</p>
</div>
<p></p>
<p>Commits are linked to their author, who must be identified by git.
Generally, git uses the system information.
If it does not succeed, a window asks the user to identify himself before making his first <em>commit</em> (figure <a href="chap-git.html#fig:git-id">3.5</a>).
The commands shown are to be executed in the RStudio terminal.
They can also be used to check the values known by git:</p>
<pre><code>git config user.name
git config user.email</code></pre>
<p>After the first commit, the main branch of the repository, called “master”, is created.
A branch is a version of the repository, with its own history and therefore its own files.
Branches allow:</p>
<ul>
<li>To develop new features in a project, without disturbing the main branch which may contain a stable version.
If the development is accepted, its branch can be merged with the <em>master</em> branch to create a new stable version.</li>
<li>To host files totally different from those of the main branch, for other purposes.
On GitHub, a project’s web pages can be placed in a branch called “gh-pages” which will never be merged.</li>
</ul>
<p>The git repository is fully constituted.
In git vocabulary, it consists of three <em>trees</em> (figure <a href="chap-git.html#fig:git-Trees">3.6</a>):</p>
<ul>
<li>The working directory, or sandbox, which contains files that are not staged: unknown, modified, deleted or renamed (“Staged” box unchecked).</li>
<li>The index, which contains the files taken into account (“Staged” box checked).</li>
<li>The head, which contains the validated files.</li>
</ul>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Trees"></span>
<img src="images/git-Trees.png" alt="git’s trees. Source: https://rogerdudler.github.io/git-guide/index.fr.html" width="80%"><p class="caption">
Figure 3.6: git’s trees. Source: <a href="https://rogerdudler.github.io/git-guide/index.fr.html" class="uri">https://rogerdudler.github.io/git-guide/index.fr.html</a>
</p>
</div>
<p></p>
<p>The status of the files is represented by two icons in the RStudio <em>Git</em> window: two question marks when they are not in git’s index.
Then, the icon on the right describes the difference between the working directory and the index.
The one on the left describes the difference between the index and the head.
So a modified file will have the <code>M</code> icon displayed on the right before it is taken into account, then on the left after it is taken into account.
It is possible, although better to avoid it, to modify again a file that has been taken into account before it is validated: then, both icons will be displayed.</p>
</div>
<div id="create-an-empty-repository-on-github" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Create an empty repository on GitHub<a class="anchor" aria-label="anchor" href="#create-an-empty-repository-on-github"><i class="fas fa-link"></i></a>
</h3>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:CreateRepo"></span>
<img src="images/CreateRepo.png" alt="Create a repository on GitHub." width="80%"><p class="caption">
Figure 3.7: Create a repository on GitHub.
</p>
</div>
<p></p>
<p>An empty repository on GitHub must be created (figure <a href="chap-git.html#fig:CreateRepo">3.7</a>):</p>
<ul>
<li>On GitHub, click on the green “New repository” button.</li>
<li>Enter the name of the repository, identical to the local R project.</li>
<li>Add a description, which will appear only on the GitHub page of the repository.</li>
<li>Choose the status of the repository:
<ul>
<li>Public: visible to everyone.</li>
<li>Private: visible only to project collaborators, which excludes adding web pages.</li>
</ul>
</li>
<li>Do not add any <code>README</code>, <code>.gitignore</code> or license: the project must be empty.</li>
<li>Click on “create Repository”.</li>
<li>Copy the address of the repository (<a href="https://github.com/" class="uri">https://github.com/</a>… or <a href="mailto:git@github.com" class="email">git@github.com</a>:…).</li>
</ul>
<p>The choice of the address is linked to the authentication method.
SSH authentication (see section <a href="chap-logiciels.html#sec:SSH">1.4.3</a>) is preferred.</p>
</div>
<div id="linking-git-and-github" class="section level3" number="3.2.5">
<h3>
<span class="header-section-number">3.2.5</span> Linking git and GitHub<a class="anchor" aria-label="anchor" href="#linking-git-and-github"><i class="fas fa-link"></i></a>
</h3>
<p>In RStudio, a first <em>commit</em> must at least have taken place for the main branch of the project, named “master”, to exist.
At the top right of the <em>Git</em> window (figure <a href="chap-git.html#fig:git-Fichiers">3.3</a>), it shows “(no branch)” before that.
Then it is displayed “master”, the default name of the main branch of the project.
The project can then be linked to the GitHub repository.</p>
<div id="graphical-method" class="section level4" number="3.2.5.1">
<h4>
<span class="header-section-number">3.2.5.1</span> Graphical method<a class="anchor" aria-label="anchor" href="#graphical-method"><i class="fas fa-link"></i></a>
</h4>
<p>Click on the purple button next to “master”: a window appears (usually used for creating a new branch, see section <a href="chap-git.html#sec:branches">3.4</a>).
Enter the name of the “master” branch, click on “Add Remotes” and complete:</p>
<ul>
<li>Remote Name: <code>origin</code>.</li>
<li>Remote URL: paste the address of the GitHub repository.</li>
<li>Click on “Add”.</li>
</ul>
<p>Check the “Sync with Remote” box.</p>
<p>At the message indicating that a <em>master</em> branch already exists, click on “Overwrite”.</p>
</div>
<div id="on-the-command-line" class="section level4" number="3.2.5.2">
<h4>
<span class="header-section-number">3.2.5.2</span> On the command line<a class="anchor" aria-label="anchor" href="#on-the-command-line"><i class="fas fa-link"></i></a>
</h4>
<p>Instead of the previous manipulation, the link between Git and GitHub can be set up by some git commands executed in the RStudio terminal.
These are displayed on the home page of any newly created empty repository on GitHub and can therefore be copied and pasted directly to the terminal.</p>
<pre><code>git remote add origin git@github.com:&lt;GitHubID&gt;/&lt;RepoID&gt;.git
git branch -M master
git push -u origin master</code></pre>
<p>The first command declares the GitHub repository as a remote repository.
The name <em>origin</em> is a git convention.
It can be changed, but the organization of the project will be more readable if it follows the convention.
The repository address is <code>https://github.com/&lt;GitHubID&gt;/&lt;RepoID&gt;.git</code> if HTTPS authentication is chosen.</p>
<p>The following commands activate the main branch of the project and push its content to GitHub.</p>
<p>Be careful with the name of the main branch (see section <a href="chap-git.html#sec:branches">3.4</a>): by default, it is called “master” in a project created in RStudio but “main” on GitHub.
The above command lines provided by GitHub therefore replace <code>master</code> with <code>main</code> and must be corrected to match the name of the branch created by RStudio.</p>
</div>
<div id="authentication" class="section level4" number="3.2.5.3">
<h4>
<span class="header-section-number">3.2.5.3</span> Authentication<a class="anchor" aria-label="anchor" href="#authentication"><i class="fas fa-link"></i></a>
</h4>
<p>If HTTPS authentication is chosen, the first time RStudio connects to GitHub, a window allows you to enter your GitHub credentials (figure <a href="chap-git.html#fig:git-PAT">3.8</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-PAT"></span>
<img src="images/git-PAT.png" alt="Identification HTTPS sur GitHub." width="80%"><p class="caption">
Figure 3.8: Identification HTTPS sur GitHub.
</p>
</div>
<p></p>
<p>As of August 2021, GitHub no longer accepts the user’s account password for this authentication: the personal token (PAT) created in section <a href="chap-logiciels.html#sec:pat">1.4.4</a> must be entered instead.</p>
<p>If SSH authentication is chosen and has been configured at git installation (section <a href="chap-logiciels.html#sec:SSH">1.4.3</a>), no action is necessary.</p>
</div>
</div>
<div id="push-the-first-modifications" class="section level3" number="3.2.6">
<h3>
<span class="header-section-number">3.2.6</span> Push the first modifications<a class="anchor" aria-label="anchor" href="#push-the-first-modifications"><i class="fas fa-link"></i></a>
</h3>
<p>The previous manipulation has automatically pushed the validated modifications on GitHub.
Afterwards, you will have to click on the “Push” button of the <em>Git</em> window to do it.</p>
<p>On GitHub, the files resulting from the modifications recorded by git are now visible.</p>
<p>Each commit done locally is counted by git and a message “Your branch is ahead of ‘origin/master’ by <em>n</em> commits” displayed in the top of the <em>Git</em> window indicates that it is time to update GitHub by pushing all these commits.
Click on the “Push” button to do so.</p>
<p>At this point, the project should have a <code>README.md</code> file that presents its contents on GitHub.
Its minimal content is a title and a few lines of description:</p>
<pre><code># Project name

Description in a few lines.
</code></pre>
<p>It is advisable to use badges<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/orangemug/stability-badges" class="uri"&gt;https://github.com/orangemug/stability-badges&lt;/a&gt;&lt;/p&gt;'><sup>35</sup></a>, to be placed just after the title, to declare the maturity status of the project, for example:</p>
<pre><code>![stability-wip](https://img.shields.io/badge/|&gt;
stability-work_in_progress-lightgrey.svg)</code></pre>
</div>
<div id="clone-a-repository-from-github" class="section level3" number="3.2.7">
<h3>
<span class="header-section-number">3.2.7</span> Clone a repository from GitHub<a class="anchor" aria-label="anchor" href="#clone-a-repository-from-github"><i class="fas fa-link"></i></a>
</h3>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Clone"></span>
<img src="images/git-Clone.png" alt="Cloning a repository from GitHub." width="80%"><p class="caption">
Figure 3.9: Cloning a repository from <em>GitHub.</em>
</p>
</div>
<p></p>
<p>Any repository on GitHub can be installed (<em>cloned</em>) on the workstation by copying its address which appears by clicking on the green button (figure <a href="chap-git.html#fig:git-Clone">3.9</a>).</p>
<p>In RStudio, create a new project and, in the wizard, choose “Version Control”, “Git” and paste the address in the “Repository URL” field.
The name of the directory to create for the project is automatically deduced from the address.
Choose the directory in which the project will be created and click on “Create Project”.
The created project is linked to the remote repository on GitHub.</p>
<p>To work with several people on the same project, the project owner must give access to the project to collaborators (figure <a href="chap-git.html#fig:git-Access">3.10</a>), i.e. other GitHub users in the repository settings.</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-Access"></span>
<img src="images/git-Access.png" alt="Assigning access rights on GitHub." width="80%"><p class="caption">
Figure 3.10: Assigning access rights on GitHub.
</p>
</div>
<p></p>
<p>Collaborators are invited by a message sent by <em>GitHub</em>.</p>
</div>
</div>
<div id="common-usage" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Common usage<a class="anchor" aria-label="anchor" href="#common-usage"><i class="fas fa-link"></i></a>
</h2>
<div id="pull-modify-commit-push" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Pull, modify, commit, push<a class="anchor" aria-label="anchor" href="#pull-modify-commit-push"><i class="fas fa-link"></i></a>
</h3>
<p>Any work session on a project starts by pulling (“Pull” button) from the <em>Git</em> window to integrate to the local repository the updates made on GitHub by other collaborators.</p>
<p>The changes made to the project files are then taken into account (check the “Staged” boxes) and committed with an explanatory message.
A good practice is to validate changes each time an elementary task which can be described in the explanatory message is completed rather than making <em>commits</em> that group many changes with a vague description.</p>
<p>As soon as possible, <em>Push</em> updates so that they are visible to collaborators.</p>
</div>
<div id="resolve-conflicts" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Resolve conflicts<a class="anchor" aria-label="anchor" href="#resolve-conflicts"><i class="fas fa-link"></i></a>
</h3>
<p>It is not possible to push validated changes if a collaborator has modified the remote repository on GitHub.
In this case, you have to pull them to the local repository before pushing the merged changes.</p>
<p>A conflict occurs if a <em>Pull</em> imports a change into the local file that cannot be merged automatically because a conflicting change occurred locally.
Git considers each line to be indivisible: changing the same line in the remote repository and the local repository therefore generates a conflict.</p>
<p>Git inserts both versions in the file containing a conflict with a particular presentation:</p>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD # Imported version of the conflict
Lines in conflict, imported version
========= # boundary between the two versions
Lines in conflict, local version
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; # End of conflict</code></pre>
<p>The formatting lines containing the <code>&lt;&lt;&lt;&lt;</code>, the <code>====</code> and the <code>&gt;&gt;&gt;&gt;</code> must be deleted and only one version of the problematic lines kept, which can be different from the two original versions.
The conflict resolution must be taken into account and validated.</p>
<p>To limit conflicts in a document containing text (typically, an R Markdown document), a good practice is to treat each sentence as a line, terminated by a line break that will not be visible in the formatted document: two line breaks are required to separate paragraphs.</p>
</div>
<div id="see-the-differences" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> See the differences<a class="anchor" aria-label="anchor" href="#see-the-differences"><i class="fas fa-link"></i></a>
</h3>
<p>In the RStudio <em>Git</em> window, the context menu (displayed by right-clicking) “Diff” can be used to display the changes made to each file (figure <a href="chap-git.html#fig:git-diff">3.11</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-diff"></span>
<img src="images/git-diff.png" alt="Differences between the working directory and the head." width="80%"><p class="caption">
Figure 3.11: Differences between the working directory and the head.
</p>
</div>
<p></p>
</div>
<div id="revert" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Revert<a class="anchor" aria-label="anchor" href="#revert"><i class="fas fa-link"></i></a>
</h3>
<p>The contextual menu “Revert” allows you to undo all the modifications made to a file (displayed by <em>Diff</em>) and to restore its content validated the last time (its state in the head).</p>
<p>It is not easy to go back beyond the last validation because the modifications may have been taken into account by collaborators: deleting them would make the project incoherent.</p>
</div>
<div id="view-history" class="section level3" number="3.3.5">
<h3>
<span class="header-section-number">3.3.5</span> View history<a class="anchor" aria-label="anchor" href="#view-history"><i class="fas fa-link"></i></a>
</h3>
<p>The clock-shaped button in the RStudio <em>Git</em> window displays the history of the project (figure <a href="chap-git.html#fig:git-history">3.12</a>).</p>

<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:git-history"></span>
<img src="images/git-historique.png" alt="History of commits in the repository." width="80%"><p class="caption">
Figure 3.12: History of commits in the repository.
</p>
</div>
<p></p>
<p>At the top is the head, and then all the commits that made it up.
For each validation, the differences of each file can be displayed by clicking on the file name in the lower part of the window.</p>
</div>
</div>
<div id="sec:branches" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Branches<a class="anchor" aria-label="anchor" href="#sec:branches"><i class="fas fa-link"></i></a>
</h2>
<p>The branches of a project are different but simultaneous versions.
A typical use is the development of a new feature.
If it takes a long time to write, the project is disturbed by the current work in progress: the code may not work anymore.
If the development turns out to be impossible or useless, it must be abandoned without damage.
In order to isolate it during its development and to be able to validate or abandon it at the end, it must be placed in a branch.</p>
<p>The main branch of the project is called “master” or “main” from November 2020<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/github/renaming" class="uri"&gt;https://github.com/github/renaming&lt;/a&gt;&lt;/p&gt;'><sup>36</sup></a>.
It must always be in a stable state: it is the one that is cloned from GitHub by other possible users.</p>
<p>The change of convention for the name of the “master” branch means that from November 2020, projects created on GitHub cloned in RStudio have the main branch “main” while projects created on RStudio and then linked to GitHub keep the “master” name.</p>
<div id="create-a-new-branch" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Create a new branch<a class="anchor" aria-label="anchor" href="#create-a-new-branch"><i class="fas fa-link"></i></a>
</h3>
<p>Click on the purple “New Branch” button in the RStudio <em>git</em> window.
Enter its name and click on “Create”.</p>
<p>The new branch is now active.</p>
<p>The git commands can also be run in the terminal (to create the branch and activate it):</p>
<pre><code>git branch new_branch
git checkout new_branch</code></pre>
</div>
<div id="change-branch" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Change branch<a class="anchor" aria-label="anchor" href="#change-branch"><i class="fas fa-link"></i></a>
</h3>
<p>Select the branch to activate from the list of local branches in the <em>git</em> window.</p>
<p>The <em>commits</em> apply to the active branch.
Each branch behaves as a different version of the project.</p>
<p>Warning: to avoid confusion, save the changes, stage them and commit them before changing branch.</p>
</div>
<div id="pushing-the-new-branch" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Pushing the new branch<a class="anchor" aria-label="anchor" href="#pushing-the-new-branch"><i class="fas fa-link"></i></a>
</h3>
<p>The first modifications of the new branch must be pushed with the command line because the “Push” and “Pull” buttons of the <em>Git</em> window do not work as long as the branch does not exist on the remote repository.</p>
<p>Run, in the terminal:</p>
<pre><code>git push -u origin new_branch</code></pre>
</div>
<div id="filesystem-behavior" class="section level3" number="3.4.4">
<h3>
<span class="header-section-number">3.4.4</span> Filesystem behavior<a class="anchor" aria-label="anchor" href="#filesystem-behavior"><i class="fas fa-link"></i></a>
</h3>
<p>Each time a branch changes, git rewrites the project files to reflect the state of the branch.
The changes can be seen outside of RStudio, in the file browser for example.</p>
<p>Files ignored by <code>.gitignore</code> are not changed.
It is therefore essential that the <code>.gitignore</code> files in the different branches are identical, otherwise files ignored in one branch will appear as added in the displayed branch after a change.</p>
<p>Development branches have a content close to that of the main branch.
This is not the case with specialized branches seen later, such as <code>gh-pages</code> (see section <a href="chap-git.html#sec:github-pages">3.7</a>) which contains the repository’s presentation web site.
It is best not to attempt to display these branches in RStudio: their content is produced automatically and should not be modified manually.
If it is necessary, it will be necessary to copy the <code>.gitignore</code> file of the main branch and keep in mind that the ignored files actually belong to another branch than the one displayed.</p>
</div>
<div id="merge-with-merge" class="section level3" number="3.4.5">
<h3>
<span class="header-section-number">3.4.5</span> Merge with <code>merge</code><a class="anchor" aria-label="anchor" href="#merge-with-merge"><i class="fas fa-link"></i></a>
</h3>
<p>Merging a development branch with the main branch marks the achievement of its goal: its code will be integrated into the project.
RStudio’s GUI does not allow for merging, so you have to use the terminal: first, go to the target branch (possible with the GUI):</p>
<pre><code>git checkout master</code></pre>
<p>Then, merge:</p>
<pre><code>git merge new_branch</code></pre>
<p>In most situations, the merge will be automatic (“Fast Forward”).
It is possible that conflicts appear: use the <code>git status</code> command to display the list of files concerned, open them, resolve the conflict and perform a <em>commit</em>.</p>
<p>The merged branch is not deleted: it can be used again for further development or deleted manually with the following command:</p>
<pre><code>git branch -d new_branch</code></pre>
</div>
<div id="merging-with-a-pull-request" class="section level3" number="3.4.6">
<h3>
<span class="header-section-number">3.4.6</span> Merging with a pull request<a class="anchor" aria-label="anchor" href="#merging-with-a-pull-request"><i class="fas fa-link"></i></a>
</h3>
<p>The other way of merging is more formal but also more general: it allows you to merge a branch into another user’s repository to contribute to it, or to have your branch validated by another team member in a collaborative project.</p>
<p>To contribute to another GitHub user’s project<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://git-scm.com/book/fr/v2/GitHub-Contribution-%C3%A0-un-projet" class="uri"&gt;https://git-scm.com/book/fr/v2/GitHub-Contribution-%C3%A0-un-projet&lt;/a&gt;&lt;/p&gt;'><sup>37</sup></a>, you have to start by creating a <em>fork</em> of it, i.e. a copy in the form of a repository linked to the original.
It will be possible to pull changes from the original to stay up to date<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ardalis.com/syncing-a-fork-of-a-github-repository-with-upstream/" class="uri"&gt;https://ardalis.com/syncing-a-fork-of-a-github-repository-with-upstream/&lt;/a&gt;&lt;/p&gt;'><sup>38</sup></a> (as opposed to a simple snapshot copy made by downloading a zip of the project) and, at the end of the development, to merge the <em>fork</em> to the original repository (as opposed to a clone that would not allow to contribute afterwards).</p>
<p>Next, create a development branch as before, modify it and finally ask the repository owner to merge it.
This process is described in detail in the git documentation.</p>
<p>In the simpler case of a branch of one’s own project as in the case of a <em>fork</em>, the development branch is ready to be merged.
It must have been pushed on GitHub.
On the GitHub page of the project, a “Create Pull Request” button allows to request the merge.
A message describing the proposed changes with their arguments must be added.</p>
<p>The owner of the project (the team members in the case of a collaborative project, or yourself if the team is reduced to one person) is notified of the pull request.
On the original project page, it is possible to see the message, the list of modifications (chronology of <em>commits</em> or comparison of files), to start a discussion with the author of the request…
If the request is not accepted, it can be closed.
If it is validated, the “Merge Pull Request” button allows to merge the development branch with the “master” branch (or another one) of the source project.</p>
<p>Pull requests are the only way to contribute to a repository on which you don’t have write rights.
It is also the way to merge a development branch into your own project by keeping an explicit trace of it (in the <em>Pull requests</em> section of the project’s GitHub page).
In a collaborative project, the proposals of a member (author of the request) can be validated by another (who accepts the merge).</p>
</div>
</div>
<div id="advanced-usage" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Advanced usage<a class="anchor" aria-label="anchor" href="#advanced-usage"><i class="fas fa-link"></i></a>
</h2>
<div id="git-commands" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Git commands<a class="anchor" aria-label="anchor" href="#git-commands"><i class="fas fa-link"></i></a>
</h3>
<p>Beyond the common use allowed by the RStudio graphical interface, advanced manipulations of projects are allowed by using git in command line.
Some useful examples are presented here.</p>
<p>A short guide of commands is proposed by Roger Dudler<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://rogerdudler.github.io/git-guide/index.fr.html" class="uri"&gt;https://rogerdudler.github.io/git-guide/index.fr.html&lt;/a&gt;&lt;/p&gt;'><sup>39</sup></a>.
It summarizes the essential commands, thus integrated in the graphical interface of RStudio.
Links to more complete references are given at the bottom of the page.</p>
</div>
<div id="size-of-a-repository" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Size of a repository<a class="anchor" aria-label="anchor" href="#size-of-a-repository"><i class="fas fa-link"></i></a>
</h3>
<p>To find out how much disk space a repository occupies, use the command <code>git count-objects -vH</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://git-scm.com/docs/git-count-objects" class="uri"&gt;https://git-scm.com/docs/git-count-objects&lt;/a&gt;&lt;/p&gt;'><sup>40</sup></a>.</p>
<p>The data for this document at the time of writing is presented as an example.</p>
<pre><code>$ git count-objects -v
count: 200
size: 2.66 MiB
in-pack: 0
packs: 0
size-pack: 0
prune-packable: 0
garbage: 0
size-garbage: 0</code></pre>
<p>The total size is on the <em>size</em> line.
Packs are a method used by git to reduce the size of the repository: similar files are stored as a common part and differences.
The <em>prune-packable</em> line gives the size of objects stored both individually and in packs.
If their size is large, run <code>git prune-packed</code> to reduce it to zero.</p>
<p>The <em>size-garbage</em> line gives the size of objects that can be deleted.
<code>git gc</code> removes them, but not only that: it optimizes storage.</p>
<pre><code>git gc
Enumerating objects: 194, done.
Counting objects: 100% (194/194), done.
Delta compression using up to 8 threads
Compressing objects: 100% (188/188), done.
Writing objects: 100% (194/194), done.
Total 194 (delta 83), reused 0 (delta 0)

$ git count-objects -vH
count: 1
size: 5.72 KiB
in-pack: 194
packs: 1
size-pack: 4.00 MiB
prune-packable: 0
garbage: 0
size-garbage: 0 bytes</code></pre>
<p>Here, the majority of the objects in the repository have been placed in a pack (but its size is larger than the individual objects).</p>
<p>There is usually no need to do garbage collection manually: git handles the organization of its repositories well.</p>
<p>GitHub limits the size of repositories.
As of May 2020, the limit is 100 GB.
The size of all repositories of an authenticated user can be displayed in his account settings (“Personal Settings”, “Repositories”)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/settings/repositories" class="uri"&gt;https://github.com/settings/repositories&lt;/a&gt;&lt;/p&gt;'><sup>41</sup></a>.</p>
</div>
<div id="delete-a-folder" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Delete a folder<a class="anchor" aria-label="anchor" href="#delete-a-folder"><i class="fas fa-link"></i></a>
</h3>
<p>All changes made to a repository are stored in its history.
It can be useful to delete them in some particular cases</p>
<ul>
<li>if a file containing confidential information was inadvertently committed.
Committing its deletion does not remove it from the history, and the confidential information remains visible when consulting the history.</li>
<li>if large files are no longer needed, e.g. PDF files produced by R Markdown (chapter <a href="chap-rediger.html#chap-rediger">4</a>) which are binary (thus unsuitable for git) and reproducible from the code.</li>
</ul>
<p>Typically, the <code>docs</code> folder is used to store documents produced from R Markdown code.
The HTML and PDF files must be in this folder to constitute the GitHub pages of the project.
Each modification of the repository generates a new version of these files whose history volume quickly becomes huge.
An efficient solution is to delegate the creation of these files to a continuous integration system (chapter <a href="chap-ci.html#chap-ci">6</a>) and to remove the <code>docs</code> folder from the main branch (<em>master</em>) of the repository.
You then have to delete all its history to recover the space it occupies, which can be most of the size of the repository.</p>
<p>The commands to completely delete a folder from a repository are presented here<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://stackoverflow.com/questions/10067848/remove-folder-and-its-contents-from-git-githubs-history" class="uri"&gt;https://stackoverflow.com/questions/10067848/remove-folder-and-its-contents-from-git-githubs-history&lt;/a&gt;&lt;/p&gt;'><sup>42</sup></a>.
The repository must be clean, i.e. without unvalidated changes, and the remote and local versions synchronized.</p>
<p>The following three commands completely remove the <code>docs</code> folder from the git repository history:</p>
<pre><code>git filter-branch --tree-filter "rm -rf docs" |&gt;
    --prune-empty HEAD
git for-each-ref --format="%(refname)" refs/original/ |&gt;
    | xargs -n 1 git update-ref -d</code></pre>
<p>The <code>docs</code> folder is not removed from the working directory.
It must therefore be added to the <code>.gitignore</code> file so that it is no longer tracked.
The modification of <code>.gitignore</code> must be validated.
These operations can be done with the RStudio interface or on the command line:</p>
<pre><code>echo docs/ &gt;&gt; .gitignore
git add .gitignore
git commit -m 'Removing docs folder from git history'</code></pre>
<p>The repository cleanup is necessary to physically remove the removed data:</p>
<pre><code>git gc</code></pre>
<p>Finally, the repository must be pushed.
The <code>--force</code> option involves replacing the contents of the remote repository with those of the local repository: all changes made by collaborators are erased, so this cleanup operation involves suspending the development of the project while it takes place.</p>
<pre><code>git push origin master --force</code></pre>
<p>This code can be used to completely remove any file or folder from a repository by simply replacing <code>docs</code> in the initial <code>git filter-branch</code> command.
The reduction in repository size can be tracked using <code>git count-objects -vH</code> before the operation, before <code>git gc</code> (the repository size remains stable but has been moved to <em>garbage</em>) and at the end (the repository size is significantly reduced).</p>
</div>
<div id="revert-1" class="section level3" number="3.5.4">
<h3>
<span class="header-section-number">3.5.4</span> Revert<a class="anchor" aria-label="anchor" href="#revert-1"><i class="fas fa-link"></i></a>
</h3>
<p>It is possible to restore a repository to a previous state by placing its head (figure <a href="chap-git.html#fig:git-Trees">3.6</a>) at the level of an old <em>commit</em>.
All subsequent modifications are then destroyed.
This operation should not be performed on a shared repository: other users would not be able to push their modifications anymore.</p>
<p>Display the repository history and look for the identifier (SHA) of the last <em>commit</em> to keep.
In the RStudio terminal, run:</p>
<pre><code>git reset --hard &lt;SHA&gt;
git push -f</code></pre>
<p>All repository history after the chosen restore point is lost.</p>
<p>A less drastic method that can be used on a shared repository is to perform a <em>commit</em> that undoes another’s changes but does not destroy any history data.
This operation only undoes one <em>commit</em> at a time, so it must be repeated to undo several, starting with the most recent.
In the RStudio terminal, run:</p>
<pre><code>git revert &lt;SHA&gt;</code></pre>
<p>To undo the last <em>commit</em>, execute:</p>
<pre><code>git revert HEAD</code></pre>
<p>Using <code>HEAD</code> simply avoids searching for the corresponding ID.</p>
</div>
</div>
<div id="sec:confidential" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Confidential data in a public repository<a class="anchor" aria-label="anchor" href="#sec:confidential"><i class="fas fa-link"></i></a>
</h2>
<p>A public repository on GitHub causes problems when the data used in the project is not.</p>
<p>An unsatisfactory solution is to not include the data in the project, which makes it non-reproducible.
A better solution is to encrypt them, allowing some users to decrypt them.
This is the purpose of the <strong>secret</strong> package.</p>
<p>A safe (<code>vault</code> folder) is created in the project.
It contains a list of authorized users: each of them must have a pair of encryption keys, a public key included in the safe and a private key, kept secret.
The data is encrypted with all the public keys available (and therefore duplicated).
The users then each use their own private key for decryption.</p>
<p>To avoid duplicating data, the repository owner should create a generic user for the project, whose private key he will communicate outside GitHub.
The vault will contain the keys of the project owner and the generic user only.
If the generic user’s private key is compromised, it will be sufficient to remove it from the vault and create a new one.</p>
<div id="generating-a-key-pair-for-the-project-owner" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> Generating a key pair for the project owner<a class="anchor" aria-label="anchor" href="#generating-a-key-pair-for-the-project-owner"><i class="fas fa-link"></i></a>
</h3>
<p>The keys are generated by the <em>ssh</em> software, installed with <em>git</em> or by default on Linux.</p>
<p>The procedure is the same as in the section <a href="chap-logiciels.html#sec:SSH">1.4.3</a>, but the key used must be in RSA format (supported by the <strong>secret</strong> package, as opposed to the more secure ed25519 format used for authentication on GitHub).</p>
<p>Run the following command in the RStudio terminal to create an RSA key:</p>
<pre><code>ssh-keygen -t rsa -b 4096 -C "user.email"</code></pre>
<p>Store the public key on GitHub in “Settings &gt; SSH and GPG Keys”.
Note the position of the key: if an authentication key has already been stored for two workstations for example, the RSA key will be the third one.</p>
</div>
<div id="generating-a-key-pair-for-the-project" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> Generating a key pair for the project<a class="anchor" aria-label="anchor" href="#generating-a-key-pair-for-the-project"><i class="fas fa-link"></i></a>
</h3>
<p>Generate a key in RSA format in the RStudio terminal:</p>
<pre><code>ssh-keygen -t rsa -b 4096" </code></pre>
<ul>
<li>Enter the name of the key: <code>&lt;RepoID&gt;.rsa</code>.</li>
<li>Do not enter a passphrase to allow the key to be used without interaction.</li>
</ul>
<p>The private key <code>&lt;RepoID&gt;.rsa</code> should only be distributed to the rightful owners of the project.
You must therefore add the line <code>*.rsa</code> to the <code>.gitignore</code> file of the project to avoid pushing the key on GitHub.</p>
<p>To allow the continuous integration of the project (chapter <a href="chap-ci.html#chap-ci">6</a>), the private key must be stored as a secret of the GitHub repository containing the project.
Apply the procedure in section <a href="chap-ci.html#sec:secrets-ci">6.2.2</a> to create a secret named “RSA” and paste the content of the file <code>&lt;RepoID&gt;.rsa</code> in the “Value” field of the form.</p>
<p>The use of the secret is described in section <a href="chap-ci.html#sec:secrets-ci">6.2.2</a>.</p>
</div>
<div id="creating-a-safe" class="section level3" number="3.6.3">
<h3>
<span class="header-section-number">3.6.3</span> Creating a safe<a class="anchor" aria-label="anchor" href="#creating-a-safe"><i class="fas fa-link"></i></a>
</h3>
<p>Execute:</p>
<p></p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/gaborcsardi/secret#readme">"secret"</a></span><span class="op">)</span></span>
<span><span class="va">vault</span> <span class="op">&lt;-</span> <span class="st">"vault"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/create_package_vault.html">create_vault</a></span><span class="op">(</span><span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="adding-users" class="section level3" number="3.6.4">
<h3>
<span class="header-section-number">3.6.4</span> Adding users<a class="anchor" aria-label="anchor" href="#adding-users"><i class="fas fa-link"></i></a>
</h3>
<p>The owner of the project is added from his public key stored on GitHub, which is the third one in our example.</p>
<p></p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GitHub ID of the project owner</span></span>
<span><span class="va">github_user</span> <span class="op">&lt;-</span> <span class="st">"EricMarcon"</span></span>
<span><span class="co"># Read and store the key, i is the key number</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/add_github_user.html">add_github_user</a></span><span class="op">(</span><span class="va">github_user</span>, vault <span class="op">=</span> <span class="va">vault</span>, i <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>The generic project user’s key is added by:</p>
<p></p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://jeroen.r-universe.dev/openssl">"openssl"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Linking to: OpenSSL 1.1.1t  7 Feb 2023</code></pre>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_id</span> <span class="op">&lt;-</span> <span class="st">"ProjectName"</span></span>
<span><span class="co"># Read the key</span></span>
<span><span class="va">rsa_project</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openssl/man/read_key.html">read_pubkey</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">project_id</span>, <span class="st">".rsa.pub"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Add to the vault</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/add_user.html">add_user</a></span><span class="op">(</span><span class="va">project_id</span>, public_key <span class="op">=</span> <span class="va">rsa_project</span>, vault <span class="op">=</span> <span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<p></p>
</div>
<div id="storing-the-data" class="section level3" number="3.6.5">
<h3>
<span class="header-section-number">3.6.5</span> Storing the data<a class="anchor" aria-label="anchor" href="#storing-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>The data, stored in R variables, are stored one by one by the <code><a href="https://rdrr.io/pkg/secret/man/add_secret.html">add_secret()</a></code> function.
In the following example, the variable is called <code>X</code> and equals 1.</p>
<p></p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/add_secret.html">add_secret</a></span><span class="op">(</span></span>
<span>  <span class="co"># Name of the data</span></span>
<span>  <span class="st">"X"</span>, </span>
<span>  <span class="co"># Value</span></span>
<span>  value <span class="op">=</span> <span class="va">X</span>, </span>
<span>  <span class="co"># Authorized users: owner and generic</span></span>
<span>  users <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"github-"</span>, <span class="va">github_user</span><span class="op">)</span>, <span class="va">project_id</span><span class="op">)</span>, </span>
<span>  <span class="co"># Vault</span></span>
<span>  vault <span class="op">=</span> <span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>The contents of the vault can be checked:</p>
<p></p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of vault data</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/list_secrets.html">list_secrets</a></span><span class="op">(</span>vault <span class="op">=</span> <span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   secret        email
## 1      X github-E....</code></pre>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of owners of the data 'X</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/list_owners.html">list_owners</a></span><span class="op">(</span><span class="st">"X"</span>, vault <span class="op">=</span> <span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "github-EricMarcon" "ProjectName"</code></pre>
<p></p>
<p>The data will be read into the project code by the <code><a href="https://rdrr.io/pkg/secret/man/get_secret.html">get_secret()</a></code> command.
The private key of the generic project user, communicated by a secure means to the owners, must be in the project folder.</p>
<p></p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the private key</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>USER_KEY <span class="op">=</span> <span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/proj_utils.html">proj_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">project_id</span>, <span class="st">".rsa"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## ✔ Setting active project to
## '/Users/runner/work/WorkingWithR/WorkingWithR'</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the data 'X</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/get_secret.html">get_secret</a></span><span class="op">(</span><span class="st">"X"</span>, vault <span class="op">=</span> <span class="va">vault</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p></p>
<p>The key can be verified:</p>
<p></p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/secret/man/local_key.html">local_key</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [4096-bit rsa private key]
## md5: e81dcb0745a755286c2dc1fc4c6ad117
## sha256: cca11ef82e17c3b77b699e7f3c23e083e8f0f79cb70be8274799f076c44b0c2d</code></pre>
<p></p>
</div>
</div>
<div id="sec:github-pages" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> GitHub pages<a class="anchor" aria-label="anchor" href="#sec:github-pages"><i class="fas fa-link"></i></a>
</h2>
<p>Any project on GitHub must have contained a <code>README.md</code> file to present it.
This file is written in Markdown format.</p>
<p>The file can be placed in the <code>docs</code> folder to provide both the repository’s home page and its website.
The <strong>memoiR</strong> package provides commands to automate these tasks in document projects.
A repository containing an article written in R Markdown (see section <a href="chap-rediger.html#sec:memo">4.3.2</a>) is used as an example<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/EricMarcon/Krigeage" class="uri"&gt;https://github.com/EricMarcon/Krigeage&lt;/a&gt;&lt;/p&gt;'><sup>43</sup></a>.</p>
<p>Its <code>README.md</code> file exists in both locations: it is written by the developer at the root of the project and duplicated in <code>docs</code>.</p>
<div id="activation" class="section level3" number="3.7.1">
<h3>
<span class="header-section-number">3.7.1</span> Activation<a class="anchor" aria-label="anchor" href="#activation"><i class="fas fa-link"></i></a>
</h3>
<p>To activate GitHub pages, you have to open the repository settings and modify the “GitHub Pages” item (in “Options”).
Select the project branch and the folder containing the web pages, here: <code>master</code> and <code>/docs</code>.
As an option, choosing a theme customizes the appearance of the pages.</p>
<p>The web site is accessible at an address<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://EricMarcon.github.io/Krigeage/" class="uri"&gt;https://EricMarcon.github.io/Krigeage/&lt;/a&gt;&lt;/p&gt;'><sup>44</sup></a> of the domain <em>github.io</em>.</p>
<p>The <code>README.md</code> file displayed on the home page has a very different look but the same content as the one displayed with the code on the repository page in GitHub.</p>
<p>The interest of the GitHub pages is to allow an easy access to the formatted documents when the repository contains a written production or to the documentation of R packages.
These contents will be presented in the next chapter.</p>
<p>A main website is proposed with each GitHub account, at <a href="https://GitHubID.github.io" class="uri">https://GitHubID.github.io</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Example: &lt;a href="https://EricMarcon.github.io/Krigeage/" class="uri"&gt;https://EricMarcon.github.io/Krigeage/&lt;/a&gt;&lt;/p&gt;'><sup>45</sup></a>.
It will be used to host a personal website produced by <strong>blogdown</strong>.</p>
</div>
<div id="badges" class="section level3" number="3.7.2">
<h3>
<span class="header-section-number">3.7.2</span> Badges<a class="anchor" aria-label="anchor" href="#badges"><i class="fas fa-link"></i></a>
</h3>
<p>Badges are small images, possibly dynamically updated, that provide quick information about the status of a project.
They should be placed immediately after the title of the <code>README.md</code> file.</p>
<p>A good practice is to indicate the progress in the life cycle of the project.
The corresponding badges are listed on the Tidyverse site<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.tidyverse.org/lifecycle/" class="uri"&gt;https://www.tidyverse.org/lifecycle/&lt;/a&gt;&lt;/p&gt;'><sup>46</sup></a>.</p>
<p>Their Markdown code is as follows:</p>
<pre><code>![stability-wip]
(https://img.shields.io/badge/lifecycle-maturing-blue.svg)</code></pre>
<p>The <strong>usethis</strong> package simplifies their creation by placing the necessary code in the clipboard.
Then just paste it into the file.</p>
<p></p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/badges.html">use_lifecycle_badge</a></span><span class="op">(</span><span class="st">"maturing"</span><span class="op">)</span></span></code></pre></div>
<p></p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="chap-utiliseR.html"><span class="header-section-number">2</span> Use R</a></div>
<div class="next"><a href="chap-rediger.html"><span class="header-section-number">4</span> Writing</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chap-git"><span class="header-section-number">3</span> Git and GitHub</a></li>
<li>
<a class="nav-link" href="#sec:principes-git"><span class="header-section-number">3.1</span> Principles</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec:git-cds"><span class="header-section-number">3.1.1</span> Source control</a></li>
<li><a class="nav-link" href="#git-and-github-1"><span class="header-section-number">3.1.2</span> git and GitHub</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec:creerdepot"><span class="header-section-number">3.2</span> Create a new repository</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#from-an-existing-project"><span class="header-section-number">3.2.1</span> From an existing project</a></li>
<li><a class="nav-link" href="#taking-files-into-account"><span class="header-section-number">3.2.2</span> Taking files into account</a></li>
<li><a class="nav-link" href="#committing-changes"><span class="header-section-number">3.2.3</span> Committing changes</a></li>
<li><a class="nav-link" href="#create-an-empty-repository-on-github"><span class="header-section-number">3.2.4</span> Create an empty repository on GitHub</a></li>
<li><a class="nav-link" href="#linking-git-and-github"><span class="header-section-number">3.2.5</span> Linking git and GitHub</a></li>
<li><a class="nav-link" href="#push-the-first-modifications"><span class="header-section-number">3.2.6</span> Push the first modifications</a></li>
<li><a class="nav-link" href="#clone-a-repository-from-github"><span class="header-section-number">3.2.7</span> Clone a repository from GitHub</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#common-usage"><span class="header-section-number">3.3</span> Common usage</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pull-modify-commit-push"><span class="header-section-number">3.3.1</span> Pull, modify, commit, push</a></li>
<li><a class="nav-link" href="#resolve-conflicts"><span class="header-section-number">3.3.2</span> Resolve conflicts</a></li>
<li><a class="nav-link" href="#see-the-differences"><span class="header-section-number">3.3.3</span> See the differences</a></li>
<li><a class="nav-link" href="#revert"><span class="header-section-number">3.3.4</span> Revert</a></li>
<li><a class="nav-link" href="#view-history"><span class="header-section-number">3.3.5</span> View history</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec:branches"><span class="header-section-number">3.4</span> Branches</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#create-a-new-branch"><span class="header-section-number">3.4.1</span> Create a new branch</a></li>
<li><a class="nav-link" href="#change-branch"><span class="header-section-number">3.4.2</span> Change branch</a></li>
<li><a class="nav-link" href="#pushing-the-new-branch"><span class="header-section-number">3.4.3</span> Pushing the new branch</a></li>
<li><a class="nav-link" href="#filesystem-behavior"><span class="header-section-number">3.4.4</span> Filesystem behavior</a></li>
<li><a class="nav-link" href="#merge-with-merge"><span class="header-section-number">3.4.5</span> Merge with merge</a></li>
<li><a class="nav-link" href="#merging-with-a-pull-request"><span class="header-section-number">3.4.6</span> Merging with a pull request</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#advanced-usage"><span class="header-section-number">3.5</span> Advanced usage</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#git-commands"><span class="header-section-number">3.5.1</span> Git commands</a></li>
<li><a class="nav-link" href="#size-of-a-repository"><span class="header-section-number">3.5.2</span> Size of a repository</a></li>
<li><a class="nav-link" href="#delete-a-folder"><span class="header-section-number">3.5.3</span> Delete a folder</a></li>
<li><a class="nav-link" href="#revert-1"><span class="header-section-number">3.5.4</span> Revert</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec:confidential"><span class="header-section-number">3.6</span> Confidential data in a public repository</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#generating-a-key-pair-for-the-project-owner"><span class="header-section-number">3.6.1</span> Generating a key pair for the project owner</a></li>
<li><a class="nav-link" href="#generating-a-key-pair-for-the-project"><span class="header-section-number">3.6.2</span> Generating a key pair for the project</a></li>
<li><a class="nav-link" href="#creating-a-safe"><span class="header-section-number">3.6.3</span> Creating a safe</a></li>
<li><a class="nav-link" href="#adding-users"><span class="header-section-number">3.6.4</span> Adding users</a></li>
<li><a class="nav-link" href="#storing-the-data"><span class="header-section-number">3.6.5</span> Storing the data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec:github-pages"><span class="header-section-number">3.7</span> GitHub pages</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#activation"><span class="header-section-number">3.7.1</span> Activation</a></li>
<li><a class="nav-link" href="#badges"><span class="header-section-number">3.7.2</span> Badges</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EricMarcon/WorkingWithR/blob/master/03-Git.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EricMarcon/WorkingWithR/edit/master/03-Git.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Working with R</strong>" was written by Eric Marcon. It was last built on 12/20/2023.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
